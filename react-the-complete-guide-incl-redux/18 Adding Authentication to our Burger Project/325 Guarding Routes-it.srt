1
00:00:02,200 --> 00:00:05,940
Abbiamo fatto buoni progressi e ci stiamo avvicinando alla fine di questo

2
00:00:05,980 --> 00:00:08,560
modulo, ci sono altre due cose che voglio fare.

3
00:00:08,610 --> 00:00:17,830
Uno voglio anche memorizzare l'ID utente in qualsiasi ordine che ho posto in modo che sul back-end degli ordini, non solo abbiamo gli

4
00:00:17,830 --> 00:00:24,370
ingredienti ma nei dati dell'ordine o come campo extra, memorizziamo anche l'id utente dell'utente che ha

5
00:00:24,370 --> 00:00:25,510
fatto questo 

6
00:00:25,510 --> 00:00:31,540
un altro miglioramento della nostra app e possiamo anche assicurarci di recuperare gli ordini solo

7
00:00:31,540 --> 00:00:32,560
da quell'utente.

8
00:00:32,560 --> 00:00:39,250
L'altra cosa che voglio fare  anche assicurarmi che tu possa solo visitare la pagina degli ordini

9
00:00:39,250 --> 00:00:45,430
e la pagina di checkout, anche se lo reindirizziamo l se non stai costruendo un hamburger

10
00:00:45,440 --> 00:00:46,420
ma puoi

11
00:00:46,450 --> 00:00:49,280
visitarli entrambi solo se sei loggato in.

12
00:00:49,300 --> 00:00:55,900
Quello che voglio anche fare  che se sei disconnesso come sono qui ora, se visiti /

13
00:00:55,900 --> 00:00:56,950
ordini, non puoi

14
00:00:57,010 --> 00:01:01,750
andarci, abbiamo gi rimosso l'elemento di navigazione ma la visita manuale funziona.

15
00:01:01,750 --> 00:01:03,310
Quindi queste sono le cose che voglio

16
00:01:03,310 --> 00:01:11,240
fare, iniziamo con la sorveglianza della pagina degli ordini in modo che gli utenti non autenticati non possano visitarlo. Per questo, ti ho insegnato come farlo nella sezione di routing,

17
00:01:11,470 --> 00:01:15,150
 super facile a causa del modo in cui funziona

18
00:01:15,190 --> 00:01:23,170
il router di reazione, nel contenitore dell'app dove abbiamo tutti i nostri percorsi, se non rendiamo questo componente di rotta, non otteniamo

19
00:01:23,470 --> 00:01:28,090
come andare l, semplicemente non possiamo raggiungerlo perch il router di reazione non

20
00:01:28,120 --> 00:01:34,590
ne  a conoscenza e non lo caricher mai. Per questo motivo, possiamo semplicemente aggiungere una

21
00:01:34,660 --> 00:01:42,190
costante qui al componente dell'app, mapStateToProps per accedere al nostro stato e mapparlo agli oggetti di

22
00:01:42,190 --> 00:01:44,330
scena in modo sorprendente

23
00:01:44,620 --> 00:01:53,710
e quindi qui, voglio restituire un oggetto javascript e aggiungere isAuthenticated come supporto e impostarlo allo stato uguale auth

24
00:01:53,710 --> 00:02:00,480
e questo vecchio controllo in cui confrontiamo il token con il non essere nulli.

25
00:02:00,970 --> 00:02:04,760
Passiamo ora mapStateToProps alla funzione connect e ora

26
00:02:04,990 --> 00:02:09,080
possiamo accedere isAuthenticated nel nostro container e l, voglio

27
00:02:09,340 --> 00:02:13,340
usarlo sugli ordini e sulla pagina di checkout.

28
00:02:13,360 --> 00:02:20,310
Quindi creer una nuova variabile che chiamer qui route che contiene alcuni jsx, questi dovrebbero essere i

29
00:02:20,320 --> 00:02:26,810
miei percorsi predefiniti e poi aggiunger un'istruzione if dove controller se questo puntello  Autenticato 

30
00:02:26,820 --> 00:02:27,730
il caso,

31
00:02:27,730 --> 00:02:32,220
quindi se sono registrati e quindi i percorsi appariranno diversi.

32
00:02:32,560 --> 00:02:37,820
Quindi i miei percorsi non autenticati dovrebbero essere auth e slash quindi copier

33
00:02:38,020 --> 00:02:43,150
tutto qui e rimuover il percorso di logout e ho bisogno di

34
00:02:44,860 --> 00:02:54,570
concludere questo ovviamente perch questo non  piaciuto dal mio codice jsx qui, quindi possiamo semplicemente tagliare l'istruzione switch anche qui perch questi

35
00:02:54,640 --> 00:03:00,060
ora sono tutti i nostri percorsi, non ne abbiamo bisogno laggi, questo 

36
00:03:00,090 --> 00:03:05,960
il set di routing per gli utenti non autenticati ora, corrisponde ai nostri link.

37
00:03:06,340 --> 00:03:13,170
Ora il set up per gli utenti autenticati sono i percorsi rimanenti, quindi tagliali qui e

38
00:03:13,300 --> 00:03:21,380
aggiungili qui e sbarazzati della route auth perch non ho bisogno di andare su / auth se sono autenticato,

39
00:03:21,380 --> 00:03:24,010
tutti gli altri percorsi sono comunque

40
00:03:24,230 --> 00:03:30,830
valido, quindi auth e slash sono disponibili per gli utenti non autenticati, per gli utenti autenticati,

41
00:03:30,830 --> 00:03:34,990
gli ordini di checkout, il logout e la barra sono disponibili.

42
00:03:35,140 --> 00:03:40,020
E ora nel mio codice jsx laggi sto semplicemente

43
00:03:40,040 --> 00:03:46,970
rendendo i miei percorsi cos questa variabile. Con questo abbiamo le guardie sul posto, ora non possiamo raggiungere

44
00:03:46,970 --> 00:03:47,900
la pagina degli

45
00:03:47,990 --> 00:03:49,330
ordini se non siamo

46
00:03:49,400 --> 00:03:55,370
autenticati, puoi gi vederlo qui, se vado a ordini come questo, non succede niente vedi una pagina vuota.

47
00:03:55,370 --> 00:03:57,910
Ora per non vedere solo

48
00:03:57,980 --> 00:04:04,340
una pagina vuota possiamo ovviamente assicurarci di reindirizzare l'utente, ora per farlo, per

49
00:04:04,340 --> 00:04:04,580
reindirizzare

50
00:04:04,580 --> 00:04:15,050
alla barra per qualsiasi percorso sconosciuto, ad esempio, possiamo aggiungere qui il componente di reindirizzamento e aggiungerlo alla nostra istruzione switch ,

51
00:04:15,050 --> 00:04:16,330
reindirizza alla barra.

52
00:04:16,460 --> 00:04:18,240
Ora chiudiamo questo qui, ora

53
00:04:18,500 --> 00:04:24,830
l'ordine ci reindirizza a burger builder, l'autenticazione funziona ancora, anche perch l'istruzione switch sceglie il primo

54
00:04:24,830 --> 00:04:31,050
hit ma qualcosa di sconosciuto inclusi gli ordini che ora sono sconosciuti perch non rendiamo il

55
00:04:31,050 --> 00:04:34,490
percorso che ci reindirizza alla pagina principale .

56
00:04:34,520 --> 00:04:39,200
Ora lo stesso vale per i nostri altri percorsi qui, l per qualcosa

57
00:04:39,230 --> 00:04:45,320
di sconosciuto, voglio anche andare alla pagina del percorso. E con questo abbiamo le guardie sul posto, ci assicuriamo che non possiamo visitare

58
00:04:45,320 --> 00:04:45,730
pagine che

59
00:04:45,740 --> 00:04:47,370
non dovremmo essere in grado di visitare.

60
00:04:47,390 --> 00:04:53,260
Ora una nota importante, dato che ovviamente  tutto javascript, le persone possono sempre teoricamente scavare

61
00:04:53,270 --> 00:04:59,310
nel codice sorgente e ancora manipolarlo per andare comunque sulla rotta protetta, ed  per questo

62
00:04:59,430 --> 00:05:04,830
che abbiamo una protezione sul server, per non restituire alcun dato per utenti non autenticati.

63
00:05:04,880 --> 00:05:06,490
Questo  il modo in cui

64
00:05:06,560 --> 00:05:12,260
proteggi i tuoi dati, il front end serve solo a fornire un'esperienza utente che abbia senso e a impedire all'utente di visitare accidentalmente

65
00:05:12,260 --> 00:05:17,030
una pagina alla quale non dovrebbe essere in grado di visitare perch non sar in grado di fare nulla

66
00:05:17,030 --> 00:05:17,750
su di essa.

67
00:05:18,110 --> 00:05:21,760
Quindi questa  la protezione del percorso sul frontend

68
00:05:21,770 --> 00:05:30,290
con le guardie, ora passiamo ad usare i nostri dati utente sui nostri ordini in modo che quando effettuiamo un ordine, quando

69
00:05:30,770 --> 00:05:32,600
siamo autenticati, lo usiamo davvero.

