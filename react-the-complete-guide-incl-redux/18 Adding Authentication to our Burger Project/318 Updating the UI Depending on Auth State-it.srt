1
00:00:02,280 --> 00:00:07,230
Quindi nell'ultima lezione abbiamo finalmente utilizzato un token per ottenere l'accesso a risorse

2
00:00:07,230 --> 00:00:13,530
protette, ora voglio assicurarmi che possiamo vedere nella nostra interfaccia utente dell'app se siamo autenticati o meno.

3
00:00:13,530 --> 00:00:18,000
In questo momento vediamo sempre l'autenticazione qui che ci conduce al modulo

4
00:00:18,240 --> 00:00:26,100
di autenticazione, ma anche se effettuiamo l'accesso con successo qui, continuiamo a vedere l'autenticazione qui, sarebbe meglio vedere il logout qui

5
00:00:26,100 --> 00:00:30,980
se ci siamo autenticati in modo che possiamo vedere hey siamo autenticati.

6
00:00:31,050 --> 00:00:31,590
Ovviamente potresti

7
00:00:31,590 --> 00:00:34,690
anche mostrare qualcosa come l'utente per accedere al tuo

8
00:00:34,860 --> 00:00:37,060
profilo, mi limiter comunque a logout.

9
00:00:37,200 --> 00:00:43,080
Quindi questa sarebbe una grande aggiunta alla nostra applicazione ed  facile da implementare.

10
00:00:43,170 --> 00:00:50,760
Gestiamo ci che vediamo nell'area di navigazione qui, nella cartella dei componenti sotto gli

11
00:00:50,850 --> 00:00:52,510
elementi di navigazione,

12
00:00:52,530 --> 00:01:01,170
in questo componente definiamo cosa c' dentro il nostro menu sia quello reattivo che quello desktop.

13
00:01:01,230 --> 00:01:06,410
Ora l'idea  di mostrare solo l'elemento di navigazione con autenticazione su

14
00:01:06,510 --> 00:01:08,370
di esso se non

15
00:01:08,430 --> 00:01:14,810
sei autenticato, quindi se hai bisogno di registrarti o di accedere e mostrare un link

16
00:01:14,910 --> 00:01:17,690
di disconnessione se hai effettuato l'accesso.

17
00:01:17,700 --> 00:01:25,920
Quindi per questo dobbiamo controllare il nostro stato, il nostro stato di accesso negli elementi di navigazione, gli elementi di navigazione

18
00:01:25,920 --> 00:01:30,490
ovviamente sono un componente di presentazione quindi non possiamo collegarlo a redux.

19
00:01:30,540 --> 00:01:36,160
Mentre potremmo, potremmo semplicemente trasformarlo in uno basato sulla classe e poi usare connect su

20
00:01:36,450 --> 00:01:37,550
questo componente, puoi

21
00:01:37,590 --> 00:01:38,830
farlo, non lo

22
00:01:38,880 --> 00:01:44,370
consiglierei comunque, questo rompe l'idea di avere alcuni componenti del contenitore che sono collegati al

23
00:01:44,370 --> 00:01:47,660
memorizzare e avere un sacco di componenti stupidi che

24
00:01:47,910 --> 00:01:55,530
non conoscono il negozio, quindi non consiglierei di utilizzare tale approccio. Un approccio migliore sarebbe quello di scegliere un contenitore adatto che carichi

25
00:01:55,530 --> 00:01:57,720
effettivamente gli elementi di navigazione e che

26
00:01:57,990 --> 00:02:03,780
qui non sia nella cartella contenitore ma nella cartella di layout semplicemente perch lo usiamo per avvolgere altri componenti.

27
00:02:04,290 --> 00:02:12,510
Lo schema. js file  un componente basato sulla classe e l, implementiamo la barra degli strumenti

28
00:02:12,600 --> 00:02:16,650
e il sidedrawer che sono, naturalmente, i componenti che utilizzano elementi di navigazione alla fine.

29
00:02:16,680 --> 00:02:26,250
Quindi sarebbe logico collegare il layout qui al nostro negozio in modo che possiamo passare le informazioni di autenticazione alla barra degli strumenti e al

30
00:02:26,250 --> 00:02:33,090
cassetto laterale che poi a sua volta potrebbe passarlo agli elementi di navigazione, questo  esattamente ci che

31
00:02:33,090 --> 00:02:34,040
voglio fare.

32
00:02:34,260 --> 00:02:45,020
Quindi importer la connessione da react-redux qui e collegher il mio layout, ora sono interessato a qualche stato quindi aggiunger qui

33
00:02:45,040 --> 00:02:51,990
la costante mapStateToProps, questa sar una funzione dove ricevo lo stato come sempre e

34
00:02:52,060 --> 00:02:57,580
io restituire un oggetto javascript dove mappo alcuni oggetti di scena

35
00:02:57,580 --> 00:03:06,650
a sezioni del mio stato e voglio creare una propriet che chiamer "autenticata" e la legher per dichiarare

36
00:03:07,430 --> 00:03:09,360
e ora come possiamo

37
00:03:09,710 --> 00:03:15,980
scoprire se l'utente  autenticato? Alla fine, se osserviamo il nostro auth reducer,

38
00:03:16,220 --> 00:03:22,230
vediamo che nello stato che abbiamo rilevante per l'autenticazione, se il token  nullo l'utente non

39
00:03:22,240 --> 00:03:25,520
 autenticato, se il token non  nullo, l'utente

40
00:03:25,520 --> 00:03:28,200
 autenticato, che  specialmente vero dato

41
00:03:28,280 --> 00:03:32,420
che abbiamo cancellato automaticamente un token una volta scaduto, questo 

42
00:03:32,420 --> 00:03:37,970
il codice che abbiamo aggiunto in precedenza. Quindi possiamo contare sul token che ci d un'indicazione sul fatto

43
00:03:37,970 --> 00:03:40,520
che l'utente sia autenticato o meno. Tenendo presente questo, possiamo

44
00:03:40,550 --> 00:03:47,510
tornare al layout e semplicemente impostare isAuthenticated uguale allo stato. auth. token e confrontarlo con null,

45
00:03:47,930 --> 00:03:49,680
se non  uguale

46
00:03:49,790 --> 00:03:57,500
a null, ci che questo controllo controlla che sia autenticato  vero perch siamo autenticati.

47
00:03:58,370 --> 00:04:08,110
Ora lo user insieme alla connessione quindi passer questo per connettere e avvolgere, whoops, avvolgere il componente di layout con la funzione return dalla funzione

48
00:04:08,290 --> 00:04:15,910
connect e posso usare isAuthenticated come puntello nel mio codice jsx qui o dovunque in questo componente, ovviamente, e

49
00:04:15,940 --> 00:04:21,880
voglio passarlo alla mia barra degli strumenti, quindi aggiunger un nuovo puntello qui e chiamer

50
00:04:21,940 --> 00:04:30,470
questo ad esempio Auth, e passer questo. puntelli. isAuthenticated, quindi questa propriet 

51
00:04:30,520 --> 00:04:37,190
stata mappata laggi e far lo stesso per il side drawer.

52
00:04:38,340 --> 00:04:42,650
Ora, ovviamente, ho bisogno di modificare questi due componenti per poter usare quel nuovo oggetto di scena,

53
00:04:42,900 --> 00:04:47,070
quindi andr al componente della barra degli strumenti qua e l, ora ricever le nuove informazioni

54
00:04:47,070 --> 00:04:52,550
sull'oggetto e ho bisogno di passarlo agli elementi di navigazione. Qui, chiamer questo oggetto  autenticato e

55
00:04:52,550 --> 00:04:55,760
sto cambiando questi nomi solo per assicurarmi di

56
00:04:55,770 --> 00:05:00,540
non confondere ci che sta arrivando e ci che stiamo trasmettendo, quindi

57
00:05:00,540 --> 00:05:01,610
quiAuthenticated verr passato

58
00:05:01,860 --> 00:05:09,030
agli elementi di navigazione come un puntello e passiamo agli oggetti di scena isAuth, isAuth perch questo 

59
00:05:09,690 --> 00:05:17,580
ci che abbiamo appena scelto nel layout, isAuth. Lo stesso per il cassetto laterale, ovviamente, nel cassetto laterale, l abbiamo

60
00:05:17,580 --> 00:05:19,170
anche gli elementi di navigazione

61
00:05:19,260 --> 00:05:23,500
e io lego isAuthenticated cos il nome dell'elica ho appena scelto nella barra

62
00:05:23,550 --> 00:05:29,070
degli strumenti e passo sugli oggetti di scena. isAuth.

63
00:05:29,340 --> 00:05:31,890
Con questo, salvo entrambi i componenti

64
00:05:31,890 --> 00:05:39,270
e ora negli elementi di navigazione, so che ricevo questo  un oggetto autenticato che  vero

65
00:05:39,270 --> 00:05:40,430
o falso.

66
00:05:40,440 --> 00:05:44,750
Quindi ora qui posso semplicemente rendere questo oggetto di navigazione in modo

67
00:05:44,950 --> 00:05:47,240
condizionale, posso farlo in linea o

68
00:05:47,300 --> 00:05:53,550
separato, lo far in linea e controller semplicemente se gli oggetti di scena che ricevo qui li aggiunger

69
00:05:54,000 --> 00:06:01,050
come argomento, se oggetti di scena  autenticato, questo  ovviamente il sostegno che abbiamo appena definito nel cassetto laterale

70
00:06:01,860 --> 00:06:04,060
e nella barra degli strumenti, se

71
00:06:04,230 --> 00:06:11,370
isAuthenticated  true, quindi voglio renderizzare questo elemento di navigazione, lo divider su pi righe per renderlo un po 'pi

72
00:06:11,370 --> 00:06:12,240
facile da leggere.

73
00:06:12,240 --> 00:06:22,440
L'alternativa  di rendere un oggetto di navigazione in cui effettivamente linko / logout e dove dico logout, ora / logout porta a

74
00:06:22,740 --> 00:06:29,400
un percorso che non abbiamo ancora registrato, ma questa  la logica che voglio usare.

75
00:06:29,640 --> 00:06:33,480
Salviamo questo e in questo momento possiamo vedere questo pulsante

76
00:06:33,480 --> 00:06:37,070
di disconnessione, non  corretto, mostra il logout quando

77
00:06:37,080 --> 00:06:41,630
non siamo autenticati perch non siamo autenticati quando l'app si ricarica, quindi

78
00:06:41,760 --> 00:06:45,770
controlliamo rapidamente la logica nel contenitore del layout , isAuthenticated

79
00:06:45,780 --> 00:06:50,100
 legato allo stato di token che inizialmente  nullo, quindi

80
00:06:50,100 --> 00:06:56,610
 corretto, ma negli elementi di navigazione ho un errore logico, se sono autenticato allora ovviamente non

81
00:06:56,610 --> 00:06:58,850
voglio mostrare l'autenticazione ma il logout.

82
00:06:59,010 --> 00:07:03,020
Quindi verificher il contrario se non mi autenticher aggiungendo un punto

83
00:07:03,150 --> 00:07:04,420
esclamativo, quindi visualizzer

84
00:07:04,680 --> 00:07:08,010
l'autenticazione altrimenti il logout, in questo ordine ha senso.

85
00:07:08,010 --> 00:07:09,960
Ora salviamo questo file e ora,

86
00:07:10,170 --> 00:07:13,570
se l'app si ricarica, vedi che l'autenticazione  l'impostazione predefinita.

87
00:07:13,590 --> 00:07:18,950
Ora, se effettuiamo l'accesso, quindi passeremo all'accesso e all'invio, vedremo che

88
00:07:19,050 --> 00:07:21,540
verr scambiato per il logout.

89
00:07:21,810 --> 00:07:28,200
Quindi ora aggiorniamo l'interfaccia utente, nella prossima lezione faremo in modo che quando facciamo clic su logout, facciamo effettivamente qualcosa

90
00:07:28,200 --> 00:07:30,540
perch in questo momento questa rotta non esiste.

