1
00:00:02,200 --> 00:00:05,940
Hicimos un buen progreso y estamos llegando al final de este

2
00:00:05,980 --> 00:00:08,560
mdulo, hay dos cosas ms que quiero hacer.

3
00:00:08,610 --> 00:00:17,830
Tambin quiero guardar la ID de usuario en cualquier orden que coloque para que en el back-end de los pedidos, no solo tengamos los ingredientes, sino

4
00:00:17,830 --> 00:00:24,370
tambin los datos de pedido o como campo adicional, tambin almacenamos la identificacin de usuario del usuario que

5
00:00:24,370 --> 00:00:25,510
realiz ese orden,

6
00:00:25,510 --> 00:00:31,540
esa es otra buena mejora para nuestra aplicacin y tambin podemos asegurarnos de que solo obtengamos pedidos

7
00:00:31,540 --> 00:00:32,560
de ese usuario.

8
00:00:32,560 --> 00:00:39,250
Otra cosa que quiero hacer es tambin asegurarme de que solo puede visitar la pgina de

9
00:00:39,250 --> 00:00:45,430
pedidos y la pgina de pago, aunque redirigamos all si no est compilando una hamburguesa,

10
00:00:45,440 --> 00:00:46,420
pero puede

11
00:00:46,450 --> 00:00:49,280
visitar ambas solo si est conectado en.

12
00:00:49,300 --> 00:00:55,900
Lo que tambin quiero hacer es que, si est desconectado como estoy aqu ahora, si visita /

13
00:00:55,900 --> 00:00:56,950
ordena, no puede

14
00:00:57,010 --> 00:01:01,750
ir all, ya quitamos el elemento de navegacin, pero visitarlo manualmente funciona.

15
00:01:01,750 --> 00:01:03,310
As que estas son las cosas que quiero

16
00:01:03,310 --> 00:01:11,240
hacer, comencemos con la proteccin de la pgina de pedidos para que los usuarios no autenticados no puedan visitarla. Para eso, te ense cmo hacer esto en la seccin de

17
00:01:11,470 --> 00:01:15,150
enrutamiento, es muy fcil debido a la forma en que

18
00:01:15,190 --> 00:01:23,170
funciona el enrutador de reaccin, en el contenedor de aplicaciones donde tenemos todas nuestras rutas, si no procesamos este componente de ruta,

19
00:01:23,470 --> 00:01:28,090
no obtenemos camino hacia all, simplemente no podemos alcanzarlo porque el enrutador de

20
00:01:28,120 --> 00:01:34,590
reaccin no est al tanto y nunca lo cargar. Por esa razn, simplemente podemos agregar

21
00:01:34,660 --> 00:01:42,190
una constante aqu al componente de la aplicacin, mapStateToProps para acceder a nuestro estado y

22
00:01:42,190 --> 00:01:44,330
asignarlo a accesorios sorprendentemente

23
00:01:44,620 --> 00:01:53,710
y luego aqu, quiero devolver un objeto javascript y agregar isAuthenticated como prop y configurar esto como estado

24
00:01:53,710 --> 00:02:00,480
auth y este cheque antiguo donde comparamos el token para no ser nulo.

25
00:02:00,970 --> 00:02:04,760
Pasemos ahora mapStateToProps a la funcin de conexin y ahora

26
00:02:04,990 --> 00:02:09,080
podemos acceder a isAuthenticated en nuestro contenedor y all, quiero

27
00:02:09,340 --> 00:02:13,340
usarlo en las rdenes y en la pgina de pago.

28
00:02:13,360 --> 00:02:20,310
As que, en realidad, crear una nueva variable a la que denominar rutas que contiene algo de jsx,

29
00:02:20,320 --> 00:02:26,810
estas deberan ser mis rutas predeterminadas y luego agregar una declaracin if donde verifico si este accesorio

30
00:02:26,820 --> 00:02:27,730
est autenticado

31
00:02:27,730 --> 00:02:32,220
es el caso, entonces si estn conectados y las rutas se vern diferentes.

32
00:02:32,560 --> 00:02:37,820
Entonces mis rutas no autenticadas deberan ser auth y slash as que

33
00:02:38,020 --> 00:02:43,150
copiar todo eso aqu y eliminar la ruta de cierre de sesin

34
00:02:44,860 --> 00:02:54,570
y necesito envolver esto, por supuesto, porque mi cdigo jsx no me gusta as que podemos cortar la declaracin de cambio aqu

35
00:02:54,640 --> 00:03:00,060
tambin porque estas son todas nuestras rutas, no las necesitamos aqu, esta

36
00:03:00,090 --> 00:03:05,960
es la configuracin de enrutamiento para usuarios no autenticados ahora, coincide con nuestros enlaces.

37
00:03:06,340 --> 00:03:13,170
Ahora la configuracin para usuarios autenticados son las rutas restantes, as que vamos a cortarlas aqu

38
00:03:13,300 --> 00:03:21,380
y agregarlas aqu y deshacernos de la ruta de autenticacin porque no necesito ir a / auth si estoy

39
00:03:21,380 --> 00:03:24,010
autenticado, todas las otras rutas son

40
00:03:24,230 --> 00:03:30,830
aunque vlido, por lo que auth y slash estn disponibles para usuarios no autenticados, para

41
00:03:30,830 --> 00:03:34,990
usuarios autenticados, rdenes de compra, logout y slash estn disponibles.

42
00:03:35,140 --> 00:03:40,020
Y ahora, en mi cdigo jsx, simplemente renderizo

43
00:03:40,040 --> 00:03:46,970
mis rutas para esta variable. Con eso tenemos guardias en su lugar, ahora no podemos acceder

44
00:03:46,970 --> 00:03:47,900
a la pgina

45
00:03:47,990 --> 00:03:49,330
de pedidos si no

46
00:03:49,400 --> 00:03:55,370
estamos autenticados, ya puedes ver esto aqu, si voy a pedidos como este, no pasa nada, ves una pgina vaca.

47
00:03:55,370 --> 00:03:57,910
Ahora, para no solo ver una

48
00:03:57,980 --> 00:04:04,340
pgina vaca, podemos asegurarnos de que redirigamos al usuario, ahora para hacerlo, para redirigir a

49
00:04:04,340 --> 00:04:04,580
una

50
00:04:04,580 --> 00:04:15,050
barra por cualquier ruta desconocida, por ejemplo, podemos agregar el componente de redireccionamiento aqu y agregarlo a nuestra declaracin de cambio , redirigir a

51
00:04:15,050 --> 00:04:16,330
solo barra.

52
00:04:16,460 --> 00:04:18,240
Ahora vamos a cerrar esto

53
00:04:18,500 --> 00:04:24,830
aqu, ahora el orden nos redirecciona al generador de hamburguesas, autenticar todava funciona porque la instruccin switch

54
00:04:24,830 --> 00:04:31,050
elige el primer hit pero cualquier cosa desconocida, incluidas las rdenes que ahora se desconocen porque no

55
00:04:31,050 --> 00:04:34,490
renderizamos esa ruta, nos redirige a la pgina principal .

56
00:04:34,520 --> 00:04:39,200
Ahora lo mismo para nuestras otras rutas aqu, all para cualquier cosa desconocida,

57
00:04:39,230 --> 00:04:45,320
tambin quiero ir a la pgina de ruta. Y con eso tenemos guardias en su lugar, nos aseguramos de que

58
00:04:45,320 --> 00:04:45,730
no podamos

59
00:04:45,740 --> 00:04:47,370
visitar pginas que no deberamos poder.

60
00:04:47,390 --> 00:04:53,260
Ahora, una nota importante, dado que esto, por supuesto, es todo javascript, las personas pueden, por supuesto, tericamente

61
00:04:53,270 --> 00:04:59,310
profundizar en su cdigo fuente y an as manipularlo para seguir yendo a la ruta protegida, y es

62
00:04:59,430 --> 00:05:04,830
por eso que tenemos proteccin en el servidor, para no devuelve ningn dato para usuarios no autenticados.

63
00:05:04,880 --> 00:05:06,490
As es como se protegen sus

64
00:05:06,560 --> 00:05:12,260
datos, la interfaz solo se trata de proporcionar una experiencia de usuario que tenga sentido y de evitar que el

65
00:05:12,260 --> 00:05:17,030
usuario visite accidentalmente una pgina a la que no debera poder acceder porque no podr hacer nada

66
00:05:17,030 --> 00:05:17,750
en eso.

67
00:05:18,110 --> 00:05:21,760
As que esta es la proteccin de ruta en

68
00:05:21,770 --> 00:05:30,290
la interfaz con guardias, ahora pasemos a usar nuestros datos de usuario en nuestros pedidos para que cuando hacemos un pedido, cuando

69
00:05:30,770 --> 00:05:32,600
estamos autenticados, efectivamente lo usemos.

