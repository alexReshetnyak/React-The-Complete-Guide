1
00:00:02,130 --> 00:00:07,900
Na ltima palestra, criamos nosso gerador de saga aqui e ele no parece muito

2
00:00:08,210 --> 00:00:11,200
til agora, bem, precisamos conect-lo  nossa loja.

3
00:00:11,390 --> 00:00:20,120
Agora, para fazer isso, precisamos ir ao local onde criamos nossa loja no ndice. js arquivo e l, agora eu no

4
00:00:20,120 --> 00:00:22,890
quero apenas criar a

5
00:00:22,940 --> 00:00:30,680
loja, eu tambm quero tambm registrar minhas sagas e certifique-se de que

6
00:00:30,680 --> 00:00:43,190
estes so algo que minha loja est ciente e pode usar. Para isso, preciso importar outra coisa, vou importar criar saga middleware do

7
00:00:43,280 --> 00:00:52,280
redux saga, assim e tambm vou importar outra coisa, vou importar a saga que acabei de criar, antes

8
00:00:52,280 --> 00:00:55,800
disso na minha auth. arquivo js na pasta

9
00:00:56,020 --> 00:01:02,420
sagas, adicionarei uma palavra-chave export na frente da minha funo de gerador e salve o arquivo.

10
00:01:02,620 --> 00:01:18,470
Ento, de volta ao ndice. js, posso importar minha saga de logout aqui. / storeSagas auth. js e para ser consistente com

11
00:01:18,470 --> 00:01:20,770
a nomenclatura, eu

12
00:01:20,840 --> 00:01:27,200
vou voltar para a auth. js arquivo na pasta sagas e nomeie esse logoutSaga como um

13
00:01:27,200 --> 00:01:30,730
nome de gerador e, portanto, eu tambm vou importar este nome, isso 

14
00:01:30,740 --> 00:01:35,880
opcional, mas tambm deixa claro o que  isso. Agora com isso importado, o

15
00:01:36,140 --> 00:01:44,240
que podemos fazer, podemos tambm executar a funo create saga middleware, armazenar o resultado em uma constante,

16
00:01:44,240 --> 00:01:54,780
ento vou nomear a constante sagaMiddleware e ento executar create sagaMiddleware, assim como sem nenhum argumento e agora quando ns criamos a

17
00:01:54,780 --> 00:02:00,180
loja, eu estou chamando applyMiddleware aqui e ali Eu no quero

18
00:02:00,180 --> 00:02:05,310
apenas aplicar o thunk middleware, mas tambm o meu saga middleware,

19
00:02:05,610 --> 00:02:08,980
ento vou adicion-lo como um argumento para applyMiddleware.

20
00:02:09,480 --> 00:02:16,680
Finalmente depois de tudo isso, eu posso usar meu sagaMiddleware que tambm est registrado na loja e l, eu posso

21
00:02:16,680 --> 00:02:18,890
rodar uma saga ento aqui eu

22
00:02:19,080 --> 00:02:28,470
posso rodar minha saga de logout que ns tambm importamos neste arquivo, certo. Agora, com isso, se eu salvar tudo isso

23
00:02:28,470 --> 00:02:35,250
e voltarmos para o nosso aplicativo e recarregarmos, bem, no vemos

24
00:02:35,640 --> 00:02:38,360
nada espetacular aqui, no ?

25
00:02:38,760 --> 00:02:44,970
Vamos para nossas ferramentas de redux dev e l vemos algo interessante, vemos

26
00:02:45,120 --> 00:02:50,390
que o logout foi executado aqui algumas vezes, agora isso faz

27
00:02:50,640 --> 00:02:59,100
sentido porque em nosso criador de ao de autenticao, ns tambm despachamos a ao de logout em nossa

28
00:02:59,100 --> 00:03:03,050
ao de verificao de estado tentamos fazer o

29
00:03:03,150 --> 00:03:13,270
login automtico do usurio, se no encontrarmos um token vlido. Agora, para fins de teste, vamos comentar todos os envios de logout, por

30
00:03:13,410 --> 00:03:19,650
isso, se salvarmos esse arquivo e voltarmos ao nosso aplicativo, se agora recarregarmos esse aplicativo, ainda

31
00:03:19,650 --> 00:03:24,980
veremos que o logout de autenticao foi enviado e que vem da nossa

32
00:03:25,230 --> 00:03:33,150
saga Eu posso provar que eles vo para o ndice. js e eu comento esta sagaMiddleware, execute a linha logout

33
00:03:33,150 --> 00:03:33,710
saga.

34
00:03:33,900 --> 00:03:39,890
Se eu fizer isso e eu voltar e agora eu recarregar a pgina, voc no ver mais isso sendo despachado.

35
00:03:40,020 --> 00:03:43,730
Ento, ns parecemos fazer algo com a nossa saga,

36
00:03:43,830 --> 00:03:45,940
estamos sempre chamando isso, ento

37
00:03:46,030 --> 00:03:52,920
deixe-me comentar em todas as coisas que comentamos, porque sempre chamar essa saga no parece muito

38
00:03:52,920 --> 00:03:55,230
til, no ? Agora, logo no

39
00:03:55,290 --> 00:04:02,070
incio, quando criamos o aplicativo, quando comeamos, executamos nossa saga de logout que, apesar desse gerador

40
00:04:02,070 --> 00:04:08,550
estranho, simplesmente faz uma coisa, remove todos esses itens do armazenamento local e despacha a

41
00:04:08,850 --> 00:04:11,490
ao de logout de autenticao.

42
00:04:11,490 --> 00:04:15,250
Obviamente, no queremos executar isso na inicializao do aplicativo, em

43
00:04:15,510 --> 00:04:23,790
vez disso, queremos executar esse cdigo no local em que executamos anteriormente nosso criador de aes de logout, no qual usamos

44
00:04:23,820 --> 00:04:25,570
isso, portanto, o objetivo

45
00:04:25,680 --> 00:04:31,650
 que realmente enviamos um ao para a qual podemos ouvir com a saga do

46
00:04:31,650 --> 00:04:38,030
redux para que o nosso gerador de saga possa ser executado assim que a ao for reconhecida.

47
00:04:38,220 --> 00:04:40,470
Vamos trabalhar nisso na prxima palestra.

