1
00:00:02,130 --> 00:00:07,900
En la ltima conferencia, creamos nuestro generador de sagas aqu y no parece muy til en este

2
00:00:08,210 --> 00:00:11,200
momento, as que tenemos que conectarlo a nuestra tienda.

3
00:00:11,390 --> 00:00:20,120
Ahora para hacer eso, tenemos que ir al lugar donde creamos nuestra tienda en el ndice. js y all, ahora no solo

4
00:00:20,120 --> 00:00:22,890
quiero crear la tienda,

5
00:00:22,940 --> 00:00:30,680
sino que tambin quiero registrar mis sagas y asegurarme de que

6
00:00:30,680 --> 00:00:43,190
sean algo que mi tienda conozca y pueda usar. Para eso, necesito importar algo ms, voy a importar crear middleware saga de

7
00:00:43,280 --> 00:00:52,280
la saga redux, as y tambin importar algo ms, importar la saga que acabo de crear, antes de eso

8
00:00:52,280 --> 00:00:55,800
en mi autorizacin. js file en la carpeta

9
00:00:56,020 --> 00:01:02,420
sagas, agregar una palabra clave de exportacin en frente de mi funcin de generador y guardar el archivo.

10
00:01:02,620 --> 00:01:18,470
As que de vuelta en el ndice. js, entonces puedo importar mi logout saga aqu desde. / storeSagas auth. js y para ser consecuente con

11
00:01:18,470 --> 00:01:20,770
el nombramiento, en

12
00:01:20,840 --> 00:01:27,200
realidad volver a la autorizacin. js file en la carpeta sagas y nombre este logoutSaga como

13
00:01:27,200 --> 00:01:30,730
nombre del generador y, por lo tanto, tambin importar este nombre, esto es

14
00:01:30,740 --> 00:01:35,880
opcional pero tambin deja en claro qu es esto. Ahora con eso importado, lo

15
00:01:36,140 --> 00:01:44,240
que podemos hacer, tambin podemos ejecutar la funcin crear middleware saga, almacenar el resultado en una constante,

16
00:01:44,240 --> 00:01:54,780
as que voy a nombrar el sagaMiddleware constante y luego ejecutar create sagaMiddleware, as sin argumentos y ahora cuando creamos la tienda, estoy

17
00:01:54,780 --> 00:02:00,180
llamando a applyMiddleware aqu y all. No solo quiero aplicar el middleware

18
00:02:00,180 --> 00:02:05,310
thunk sino tambin mi middleware saga, as que lo agregar como

19
00:02:05,610 --> 00:02:08,980
argumento para aplicar el software de Microsoft.

20
00:02:09,480 --> 00:02:16,680
Finalmente, despus de todo eso, puedo usar mi sagaMiddleware que tambin est registrado en la tienda y all, puedo ejecutar una

21
00:02:16,680 --> 00:02:18,890
saga, as que aqu puedo ejecutar mi

22
00:02:19,080 --> 00:02:28,470
saga de cierre de sesin que tambin importamos en este archivo, a la derecha. Ahora con eso, si guardo todo eso y

23
00:02:28,470 --> 00:02:35,250
volvemos a nuestra aplicacin y lo volvemos a cargar, bueno, no

24
00:02:35,640 --> 00:02:38,360
vemos nada espectacular aqu, verdad?

25
00:02:38,760 --> 00:02:44,970
Veamos nuestras herramientas de desarrollo redux y all vemos algo interesante, vemos que el

26
00:02:45,120 --> 00:02:50,390
cierre de sesin se ejecut aqu un par de veces, ahora tiene

27
00:02:50,640 --> 00:02:59,100
sentido porque en nuestro creador de acciones de autenticacin, tambin despachamos la accin de cierre de sesin en nuestra

28
00:02:59,100 --> 00:03:03,050
accin de verificacin de estado donde intentamos iniciar sesin

29
00:03:03,150 --> 00:03:13,270
automticamente con el usuario si no encontramos un token vlido. Ahora, para fines de prueba, vamos a comentar todos los despachos de salida,

30
00:03:13,410 --> 00:03:19,650
as que si guardamos este archivo y volvemos a nuestra aplicacin, si volvemos a cargar esta

31
00:03:19,650 --> 00:03:24,980
aplicacin, an vemos que se cerr el cierre de sesin de autenticacin y que

32
00:03:25,230 --> 00:03:33,150
viene de nuestra saga, como Puedo probar que van al ndice. js file y yo comento este sagaMiddleware, ejecute logout saga

33
00:03:33,150 --> 00:03:33,710
line.

34
00:03:33,900 --> 00:03:39,890
Si hago eso y vuelvo y ahora vuelvo a cargar la pgina, ya no ves que se enve.

35
00:03:40,020 --> 00:03:43,730
As que parece que hacemos algo con nuestra saga,

36
00:03:43,830 --> 00:03:45,940
siempre lo llamamos, as que

37
00:03:46,030 --> 00:03:52,920
permtanme comentar todas las cosas que comentamos, porque llamar siempre a esta saga no parece demasiado

38
00:03:52,920 --> 00:03:55,230
til, o s? En este momento,

39
00:03:55,290 --> 00:04:02,070
desde el principio, cuando creamos la aplicacin, cuando comenzamos ejecutamos nuestra sesin de cierre de sesin, que a pesar

40
00:04:02,070 --> 00:04:08,550
de que este extrao generador sucede simplemente hace una cosa: elimina todos estos elementos del almacenamiento local y distribuye

41
00:04:08,850 --> 00:04:11,490
la accin de cierre de sesin de autenticacin.

42
00:04:11,490 --> 00:04:15,250
Obviamente, no queremos ejecutar esto al inicio de la aplicacin,

43
00:04:15,510 --> 00:04:23,790
en su lugar, queremos ejecutar este cdigo en el lugar donde ejecutamos nuestro creador de acciones de cierre de sesin, donde lo

44
00:04:23,820 --> 00:04:25,570
usamos, por lo que el

45
00:04:25,680 --> 00:04:31,650
objetivo debe ser que realmente despachemos un accin a la que podemos escuchar con la saga

46
00:04:31,650 --> 00:04:38,030
redux para que nuestro generador de saga pueda ejecutarse una vez que se reconozca la accin.

47
00:04:38,220 --> 00:04:40,470
Vamos a trabajar en esto en la prxima conferencia.

